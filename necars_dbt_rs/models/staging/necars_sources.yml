version: 2

sources:
  - name: necars_source
    database: necars_db
    schema: source_schema
    tables:
      - name: vehicle_purchase
        columns:
          - name: full_stock_number
            data_tests:
              - unique:
                  arguments:
                    tags: [source]
              - not_null:
                  arguments:
                    tags: [source]
      - name: reconditioning_cost
        columns:
          - name: stock_number
            data_tests:
              - not_null:
                  arguments:
                    tags: [source]
          - name: net_cost_price
            data_tests:
              - test_non_negative_values:
                  arguments:
                    tags: [source]
          - name: sage_ref
            data_tests:
              - unique:
                  arguments:
                    tags: [source]
              - not_null:
                  arguments:
                    tags: [source]
        #       - relationships:
        #           to: source('necars_source', 'vehicle_purchase')
        #           field: "SUBSTRING(full_stock_number, 2)"
